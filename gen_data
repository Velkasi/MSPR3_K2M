import random
import pandas as pd
from faker import Faker
from datetime import timedelta, datetime

fake = Faker('fr_FR')

# core_2.T_PERSONNE_2
def generate_personnes(nb):
    return pd.DataFrame([{
        "Nom": fake.last_name(),
        "Prenom": fake.first_name()
    } for _ in range(nb)])

# core_2.T_ADRESSE_2
def generate_adresses(nb):
    return pd.DataFrame([{
        "Voie": fake.street_name(),
        "N_Voie": fake.building_number(),
        "CP": fake.postcode(),
        "Ville": fake.city()
    } for _ in range(nb)])

# core_2.T_TECHNICIEN_2
def generate_techniciens(nb):
    return pd.DataFrame([{
        "Nom_technicien": fake.last_name(),
        "Prenom_technicien": fake.first_name()
    } for _ in range(nb)])

# core_2.T_TYPE_OS_2
def generate_type_os(nb):
    return pd.DataFrame([{
        "Type_d_OS": random.choice(["Windows", "Linux", "macOS"]),
        "Version_OS": f"{random.randint(1, 11)}.{random.randint(0, 9)}"
    } for _ in range(nb)])

# client_a_2.T_INCIDENT_2
def generate_incidents(nb, instance_ids):
    return pd.DataFrame([{
        "Id_INSTANCE": random.choice(instance_ids),
        "Date_incident": fake.date_time_between(start_date="-1y", end_date="now"),
        "Description": fake.sentence(nb_words=6)
    } for _ in range(nb)])

# client_a_2.T_CONTRAT_2
def generate_contrats(nb, prestataires_ids):
    contrats = []
    for _ in range(nb):
        duree_mois = random.randint(6, 36)
        date_contrat = fake.date_between(start_date='-2y', end_date='today')
        contrats.append({
            "Duree_contrat": f"{duree_mois} mois",
            "Id_Date_contrat": date_contrat,
            "Id_Personne": random.choice(prestataires_ids)
        })
    return pd.DataFrame(contrats)

# client_a_2.T_INSTALLATION_2
def generate_installations(nb, instance_ids, technicien_ids, client_ids):
    return pd.DataFrame([{
        "Id_INSTANCE": random.choice(instance_ids),
        "Id_TECHNICIEN": random.choice(technicien_ids),
        "Id_CLIENT": random.choice(client_ids),
        "Date_installation": fake.date_between(start_date='-3y', end_date='today'),
        "Duree_installation": f"{random.randint(1, 5)} heures"
    } for _ in range(nb)])

# Génération de données de base
generate_personnes(100).to_csv("core_2.T_PERSONNE_2.csv", index=False)
generate_adresses(50).to_csv("core_2.T_ADRESSE_2.csv", index=False)
generate_techniciens(20).to_csv("core_2.T_TECHNICIEN_2.csv", index=False)
generate_type_os(10).to_csv("core_2.T_TYPE_OS_2.csv", index=False)

# Génération données supplémentaires
instance_ids = list(range(1, 51))
technicien_ids = list(range(1, 21))
client_ids = list(range(1, 51))
prestataire_ids = list(range(1, 30))

generate_incidents(100, instance_ids).to_csv("client_a_2.T_INCIDENT_2.csv", index=False)
generate_contrats(50, prestataire_ids).to_csv("client_a_2.T_CONTRAT_2.csv", index=False)
generate_installations(50, instance_ids, technicien_ids, client_ids).to_csv("client_a_2.T_INSTALLATION_2.csv", index=False)

print("Toutes les données ont été générées.")
